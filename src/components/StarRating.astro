---
/**
 * Système de notation par étoiles
 * Utilisation : <StarRating rating={4.5} maxRating={5} />
 */
interface Props {
  rating: number;
  maxRating?: number;
  showNumber?: boolean;
  size?: 'small' | 'medium' | 'large';
}

const { 
  rating, 
  maxRating = 5, 
  showNumber = true,
  size = 'medium'
} = Astro.props;

const percentage = (rating / maxRating) * 100;
const sizeClass = `stars-${size}`;
const stars = Array.from({ length: maxRating });
const containerWidth = `calc(${maxRating} * var(--star-size) + ${(maxRating - 1)} * var(--star-gap))`;

import Icon from './Icon.astro';
---

<div class={`star-rating ${sizeClass}`}>
  <div class="stars-container" style={`width: ${containerWidth};`} aria-hidden="true">
    <div class="stars-background">
      {stars.map(() => (
        <Icon name="star" class="star-icon icon-muted" />
      ))}
    </div>
    <div class="stars-filled" style={`width: ${percentage}%`}>
      {stars.map(() => (
        <Icon name="star-filled" class="star-icon icon-accent" />
      ))}
    </div>
  </div>
  {showNumber && (
    <span class="rating-number">{rating.toFixed(1)}/{maxRating}</span>
  )}
</div>
